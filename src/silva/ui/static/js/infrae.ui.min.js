(function(e,t){var n={},r={maxFactor:.8,minFactor:0,threshold:15,maxWidth:0,maxHeight:0,minWidth:0,maxHeight:0,position:["center","center"]};t.extend(n,{icon:function(e,t){t.indexOf(".")<0?e.addClass(t):e.attr("style","background:url("+t+") no-repeat center center;")},selection:{disable:function(e){return e.disableSelection()},enable:function(e){return e.enableSelection()}},ShowDialog:function(e,n){var i=t(window),s=e.dialog("widget");if(n!==undefined)for(var o in r)n[o]===undefined&&(n[o]=r[o]);else n=r;var u=function(t){var r=i.width(),o=i.height(),u=s.width(),a=s.height(),f=Math.ceil(r*n.minFactor),l=Math.ceil(o*n.minFactor),c=Math.ceil(r*n.maxFactor),h=Math.ceil(o*n.maxFactor),p=s.position(),d=t===!0,v=!1;n.maxWidth&&(c=Math.min(n.maxWidth,c)),n.maxHeight&&(h=Math.min(n.maxHeight,h)),n.minWidth&&(f=Math.max(n.minWidth,f)),n.minHeight&&(l=Math.max(n.minHeight,l)),a<l?(e.dialog("option","height",l),a=l,v=!0,h<l&&(h=l)):a>h&&(e.dialog("option","height",h),a=h,v=!0),p.top&&o-(p.top+a+n.threshold)<0&&(d=!0),u<f?(e.dialog("option","width",f),u=f,v=!0,c<f&&(c=f)):u>c&&(e.dialog("option","width",c),u=c,v=!0),p.left&&r-(p.left+u+n.threshold)<0&&(d=!0),e.dialog("option","maxHeight",h),e.dialog("option","maxWidth",c),e.dialog("option","minHeight",l),e.dialog("option","minWidth",f),d&&e.dialog("option","position",n.position),v&&e.trigger("infrae-ui-dialog-resized",{height:a,width:u})},a=function(t){t.target===window?setTimeout(u,0):t.target===s.get(0)&&e.trigger("infrae-ui-dialog-resized",{height:s.height(),width:s.width()})};i.bind("resize.infrae-ui-dialog",a),e.one("dialogclose",function(){i.unbind("resize.infrae-ui-dialog",a),e.unbind("infrae-ui-dialog-resize")}),e.bind("infrae-ui-dialog-resize",function(){u()}),e.dialog("open"),u(!0)},ResizeDialog:function(e){e.dialog("isOpen")&&e.trigger("infrae-ui-dialog-resize")},ConfirmationDialog:function(n){var r=t.Deferred(),i=t("<div></div>"),s={autoOpen:!1,modal:!0,buttons:{},zIndex:12e3};return n.title&&i.attr("title",n.title),i.html(n.message),n.buttons||(n.buttons={Cancel:function(){return!1},Continue:function(){return!0}},n.not_cancellable&&delete n.buttons.Cancel),t.each(n.buttons,function(e,t){s.buttons[e]=function(){var e=t();e.then!==undefined?e.then(r.resolve,r.reject):e?r.resolve():r.reject()}}),i.bind("dialogclose",function(){i.remove(),r.reject()}),r.always(function(){i.dialog("close")}),i.dialog(s),e.ui.ShowDialog(i),r.promise()},scroll:function(e,t,n,r,i){var s=e.scrollTop(),o;switch(n){case"up":o=s-r,i&&(o-=o%i);break;case"down":o=s+r,i&&s%i!=0&&(o+=i-o%i);break;case"absolute":default:o=r}return e.stop(!0,!0),e.animate({scrollTop:o},t),e.promise()},update_table_columns:function(e,n,r){return typeof n.fixed!="object"&&(n.fixed={}),e.each(function(){var e=t(this),i={},s={},o=0;if(r!==undefined){var u=/([0-9]+)([em%]*)/;r.find("colgroup col").each(function(e){var n=t(this).attr("width").match(u);n&&(i[e]=n[1],s[e]=n[2])})}else e.css("table-layout","auto"),e.find("tr:visible:first td").each(function(e){n.fixed[e]?(i[e]=n.fixed[e],s[e]=null):i[e]=t(this).outerWidth(),o+=i[e]});e.css("table-layout","fixed"),e.find("colgroup col").each(function(e){var n;s[e]!==undefined?(n=i[e],s[e]&&(n+=s[e])):n=Math.round(i[e]/o*100)+"%",t(this).attr("width",n)})})}}),e.ui=n})(infrae,jQuery);