(function(e,t){var n={};t.extend(n,{Callbacks:function(e,t){e||(e=[]);var r=[];return{add:function(n,r){return r&&t&&n.apply(t()),e.push(n),n},push:function(){r.push(e),e=[]},pop:function(){r.length>0&&(e=r.pop())},clone:function(){return n.Callbacks([].concat(e),t)},context:function(e){t=e},invoke:function(n,r){var i=e.length;if(!r&&t){var s=t();n?r=[s]:n=s}r||(r=[]);while(i--)e[i].apply(n,r)}}},SemaphoreCallbacks:function(){var e=0,t=[],n=undefined;return{use:function(){e+=1,n=undefined},release:function(r){if(e){e-=1;if(e)return}while(t.length)t.pop()(r);n=r},call:function(r){e?t.push(r):r(n)}}},LazyCallbacks:function(){var e=null,n=[],r=function(r,i){var s=t.Deferred(),o=[],u=0,a=r.length,f={run:function(){var t=+(new Date);while(u<a){o.push(i(r[u])),u+=1;if(+(new Date)-t>50){e=setTimeout(f.run,25);return}}e=null,n.shift(),n.length&&n[0].run(),s.resolve(o)},deferred:s};return f};return{reset:function(){var t=n.length;e&&(clearTimeout(e),e=null);while(t--)n[t].deferred.reject();n=[]},add:function(e,t){var i=n.length===0,s=r(e,t);return n.push(s),i&&s.run(),s.deferred.promise()}}},FluxCapacitor:function(){var r=[{incoming:n.Callbacks(),outgoing:n.Callbacks(),failing:n.Callbacks()}],i=[];return{events:{incoming:function(t){return e.utils.apply_on_each(i,t),r[0].incoming.add(t)},outgoing:function(e){return r[0].outgoing.add(e)},failing:function(e){return r[0].failing.add(e)},push:function(){var e={};for(var t in r[0])e[t]=r[0][t].clone();r.unshift(e)},pop:function(){r.length>1&&r.shift()}},add:function(e){return t.inArray(e,i)>-1?!1:(r[0].incoming.invoke(e),i.push(e),!0)},each:function(t){return e.utils.apply_on_each(i,t)},map:function(t){return e.utils.apply_on_map(i,t)},remove:function(e,n){var s=t.inArray(e,i);return s<0?!1:(i.splice(s,1),(n?r[0].failing:r[0].outgoing).invoke(e),!0)},clear:function(t){return e.utils.each(i,(t?r[0].failing:r[0].outgoing).invoke),i=[],!0}}}}),e.deferred=n})(infrae,jQuery);