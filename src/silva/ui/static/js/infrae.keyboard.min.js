(function(infrae,$){var module={ShortcutManager:function(document){var handlers={},zones={},order=[],selected=0,active=!1,current_name=function(){return order.length?order[selected]:null},current_zone=function(){var current=current_name();return current?zones[current]:null},current_handlers=function(){var current=current_name();return current?handlers[current]:{}},manager={create:function(name,zone,select){void 0==zones[name]&&(zones[name]=zone,order.push(name),handlers[name]={},select&&(manager.disable(!0),selected=order.length-1,manager.activate()))},remove:function(name,group){if(void 0!=zones[name])if(void 0==group)current_name()==name&&(manager.disable(),selected=0),order.splice($.inArray(name,order),1),delete zones[name],delete handlers[name];else if(void 0!=handlers[name][group]&&current_name()==name){for(var key in handlers[name][group])key&&$(document).unbind("keydown",handlers[name][group][key]);delete handlers[name][group]}},bind:function(name,group,keys,callback){var is_current=current_name()===name;void 0==group&&(group="default");for(var i=0;keys.length>i;i++){var key=keys[i];void 0==handlers[name][group]&&(handlers[name][group]={}),handlers[name][group][key]=callback,is_current&&$(document).bind("keydown",key,callback)}},activate:function(event){if(!active){var handlers=current_handlers(),zone=current_zone();event&&($(document).focus(),zone.addClass("focus"),zone.trigger("focus-keyboard"));for(var group in handlers)if(group)for(var key in handlers[group])key&&$(document).bind("keydown",key,handlers[group][key]);active=!0}},disable:function(event){if(active){var handlers=current_handlers(),zone=current_zone();for(var group in handlers)if(group)for(var key in handlers[group])key&&$(document).unbind("keydown",handlers[group][key]);event&&(zone.trigger("blur-keyboard"),zone.removeClass("focus")),active=!1}}},make_switcher=function(direction){return function(){if(order.length){manager.disable(!0),selected=(selected+direction)%order.length,0>selected&&(selected=order.length-1),manager.activate(!0);var zone=current_zone();return zone.addClass("highlight"),setTimeout(function(){zone.removeClass("highlight")},1e3),!1}}};return $(document).bind("keydown","ctrl+shift+left",make_switcher(-1)),$(document).bind("keydown","ctrl+shift+right",make_switcher(1)),$(document).bind("keydown","ctrl+left",make_switcher(-1)),$(document).bind("keydown","ctrl+right",make_switcher(1)),manager}};infrae.keyboard=module})(infrae,jQuery);