(function(e,t){var n=function(n,r){var i=e(r.notifications.selector),s={themeState:"feedback",speed:r.notifications.speed===undefined&&"normal"||r.notifications.speed},o=function(t){var n=e.extend({},s);t.category=="error"&&(n.themeState="error"),e.jGrowl(t.message,n)};e(document).on("click","#jGrowl",function(t){e(this).jGrowl("close"),t.stopPropagation(),t.preventDefault()});var u={notify:o,notifies:function(e){t.utils.each(e,u.notify)},page:function(e){return e.notifications!=undefined&&t.utils.each(e.notifications,u.notify),null},error:function(e){return e.notifications!=undefined&&t.utils.each(e.notifications,u.notify),null}};if(!r.notifications.standard&&window.webkitNotifications){var a=window.webkitNotifications,f=function(e){var t=a.checkPermission();if(t==0)return!0;if(t==1)try{return a.requestPermission(function(){}),e===!0}catch(n){return!1}return!1};f(!0)&&e.extend(u,{notify:function(e){if(f(!1)){var t=a.createNotification("",e.message,"");e.autoclose&&(t.ondisplay=function(){setTimeout(function(){t.cancel()},e.autoclose)}),t.show()}else o(e)}})}return e(document).bind("refresh-feedback-smi",function(){e.getJSON(r.notifications.url,function(e){e.notifications&&u.notifies(e.notifications)})}),e(document).bind("notify-feedback-smi",function(e,t){typeof t=="array"?u.notifies(t):u.notify(t)}),u};e.extend(t.smi.plugins,{notifications:n})})(jQuery,infrae);