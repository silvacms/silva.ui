(function(e){function n(e,t){return typeof e=="function"?e.call(t):e}function r(t,n){this.$element=e(t),this.options=n,this.enabled=!0,this.fixTitle()}var t=function(){var n=e('<div class="tipsy"><div class="tipsy-arrow"></div><div class="tipsy-inner"></div></div>');return e("body").append(n),t=function(){return n},n};r.prototype={show:function(){var r=this.getTitle();if(r&&this.enabled&&this.$element.is(":visible")){var i=t();i.find(".tipsy-inner")[this.options.html?"html":"text"](r),i[0].className="tipsy",i.css({top:0,left:0,visibility:"hidden",display:"block"});var s=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),o=i[0].offsetWidth,u=i[0].offsetHeight,a=n(this.options.gravity,this.$element[0]),f;switch(a.charAt(0)){case"n":f={top:s.top+s.height+this.options.offset,left:s.left+s.width/2-o/2};break;case"s":f={top:s.top-u-this.options.offset,left:s.left+s.width/2-o/2};break;case"e":f={top:s.top+s.height/2-u/2,left:s.left-o-this.options.offset};break;case"w":f={top:s.top+s.height/2-u/2,left:s.left+s.width+this.options.offset}}a.length==2&&(a.charAt(1)=="w"?f.left=s.left+s.width/2-15:f.left=s.left+s.width/2-o+15),i.css(f).addClass("tipsy-"+a),i.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+a.charAt(0),this.options.className&&i.addClass(n(this.options.className,this.$element[0])),this.options.fade?i.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):i.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?t().stop().fadeOut():t().hide()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("original-title")!="string")&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,n=this.options;return this.fixTitle(),typeof n.title=="string"?e=t.attr(n.title=="title"?"original-title":n.title):typeof n.title=="function"&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},e.fn.tipsy=function(t){function i(n){var i=e.data(n,"tipsy");return i||(i=new r(n,e.fn.tipsy.elementOptions(n,t)),e.data(n,"tipsy",i)),i}function s(){var e=i(this);e.hoverState="in",t.delayIn==0?e.show():(e.fixTitle(),setTimeout(function(){e.hoverState=="in"&&e.show()},t.delayIn))}function o(){var e=i(this);e.hoverState="out",t.delayOut==0?e.hide():setTimeout(function(){e.hoverState=="out"&&e.hide()},t.delayOut)}if(t===!0)return this.data("tipsy");if(typeof t=="string"){var n=this.data("tipsy");return n&&n[t](),this}t=e.extend({},e.fn.tipsy.defaults,t),this.each(function(){i(this)});if(t.trigger!="manual"){var u=t.trigger=="hover"?"mouseenter.tipsy":"focus.tipsy",a=t.trigger=="hover"?"mouseleave.tipsy":"blur.tipsy";t.delegate!==null?(this.delegate(t.delegate,u,s),this.delegate(t.delegate,a,o)):this.on(u,s).on(a,o)}return this},e.fn.tipsy.elementOptions=function(t,n){return e.metadata?e.extend({},n,e(t).metadata()):n},e.fn.tipsy.autoNS=function(){return e(this).offset().top>e(document).scrollTop()+e(window).height()/2?"s":"n"},e.fn.tipsy.autoWE=function(){return e(this).offset().left>e(document).scrollLeft()+e(window).width()/2?"e":"w"},e.fn.tipsy.autoBounds=function(t,n){return function(){var r={ns:n[0],ew:n.length>1?n[1]:!1},i=e(document).scrollTop()+t,s=e(document).scrollLeft()+t,o=e(this);return o.offset().top<i&&(r.ns="n"),o.offset().left<s&&(r.ew="w"),e(window).width()+e(document).scrollLeft()-o.offset().left<t&&(r.ew="e"),e(window).height()+e(document).scrollTop()-o.offset().top<t&&(r.ns="s"),r.ns+(r.ew?r.ew:"")}},e.fn.tipsy.defaults={className:null,delayIn:750,delayOut:0,fade:!1,fallback:"",gravity:e.fn.tipsy.autoBounds(100,"sw"),delegate:null,html:!1,offset:0,opacity:.8,title:"title",trigger:"hover"}})(jQuery);