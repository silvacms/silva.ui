(function(e,t){t.views.view({iface:"preview",name:"content",factory:function(e,t,n){return{template_data:!0,template_nocache:!0,iframe:!0,cleanup:function(){e.empty()}}}}),t.views.view({iface:"redirect",factory:function(e,t,n){return{render:function(){n.open_screen(t.path,t.screen)}}}}),t.views.view({iface:"view",factory:function(e,t,n){return{render:function(){window.open(t.url)}}}}),t.views.view({iface:"message",factory:function(e,n,r){return{render:function(){return t.ui.ConfirmationDialog({title:n.title,message:n.message,not_cancellable:!0})}}}}),t.views.view({iface:"title",factory:function(n,r,i){return{jsont:'<ins class="icon"></ins>{data.title|html}',render:function(){var s="Silva";i.options.theme&&i.options.theme.name&&(s=i.options.theme.name),t.ui.icon(n.children("ins"),r.icon),e("head > title").html(s+" - "+r.title)}}}}),t.views.view({iface:"menu",factory:function(t,n){var r=t.hasClass("tabs"),i=e([]),s=function(t,n){var o=e("<li><a></a></li>"),u=o.children("a");r&&(n?(t.screen?u.addClass("top-screen"):u.addClass("top-label"),u.addClass("top-entry"),o.addClass("top-level")):o.addClass("sub-level")),t.name?u.html("<span>"+t.name+"</span>"):t.logo&&u.html('<ins class="tab-logo '+t.logo+'"/>'),t.screen?(u.addClass("open-screen"),u.attr("rel",t.screen)):t.action?(u.addClass("open-action"),u.attr("rel",t.action)):t.url&&(u.attr("href",t.url),t.target&&u.attr("target",t.target)),t.icon&&!r&&(u.addClass("ui-state-default"),u.prepend('<div class="action-icon"><ins class="ui-icon ui-icon-'+t.icon+'"></ins></div>')),t.active&&u.addClass("active"),t.description&&u.attr("title",t.description),t.accesskey&&u.attr("accesskey",t.accesskey);if(t.entries){var a=e('<ol class="subtabs"></ol>'),f=e('<div class="subtab-icon"><ins></ins></div>'),l=t.screen&&n?f:u,c=function(t){var n=[],r=[],s=a.get(0);i.each(function(){this===s&&!t||e.contains(this,s)?n.push(this):r.push(this)}),e(r).fadeOut("fast"),i=e(n),t?i=e(n):i=e(n).add(s)};e.each(t.entries,function(e,t){a.append(s(t))}),a.bind("mouseleave",function(){c(!0)}),l.bind(n?"click":"mouseenter",function(){var t=u.offset().left,r=a.width(),i=e(document).width();if(!n){var s=u.width();t+s+r<i?a.css("left",s):a.css("right",r-5),a.css("top",0)}else t+r<i?a.css("left",0):a.css("right",0);return c(!1),a.show(),!1}),u.prepend(f),o.append(a)}return o};return{render:function(){e.each(n.entries,function(e,n){t.append(s(n,!0))}),t.tipsy({delegate:"a"}),r||t.children("li:last").addClass("last-action")},cleanup:function(){t.unbind("open-menu"),t.empty()}}}}),t.views.view({iface:"object",name:"header",factory:function(t,n,r,i,s){var o=function(e,t){t?((e.is("ol")?e:e.find("ol")).render({data:t}),e.show()):e.hide()},u=function(e,t,n){if(!n)o(e.find(".view-actions"),t.view),o(e.children(".content-tabs"),t.content),o(e.find(".compact-tabs"),undefined);else{var r=[];t.content&&(r=r.concat(t.content.entries)),t.view&&(r=r.concat(t.view.entries)),o(e.find(".view-actions"),undefined),o(e.children(".content-tabs"),undefined),o(e.find(".compact-tabs"),{ifaces:["menu"],entries:[{logo:"tab-options",active:!0,entries:r}]})}};return{render:function(){var o=t.children(".metadata"),a=t.find("a.parent"),f=t.hasClass("compact-header");o.children("h2").render({data:n.title,args:[r,s]}),o.children("#content-url").attr("href",i.expand({path:n.path})),u(o,n.menu,f),t.children(".toolbar").render({data:n,name:"toolbar",args:[r,s]}),n.up!=null?(a.attr("href",n.up||"/"),a.attr("rel",r.opened.tab),a.removeClass("ui-state-disabled"),a.addClass("ui-state-default")):(a.addClass("ui-state-disabled"),a.removeClass("ui-state-default")),e(window).bind("fullscreen-resize-smi.default-header",function(e,t){u(o,n.menu,t.active)})},cleanup:function(){e(window).unbind("fullscreen-resize-smi.default-header")}}}}),t.views.view({iface:"object",name:"toolbar",factory:function(e,n){return{render:function(){var r=n.menu.actions;r&&r.entries.length&&(e.html('<div class="actions content-actions"><ol></ol></div>'),t.ui.selection.disable(e),e.find(".content-actions ol").render({data:r}))},cleanup:function(){e.empty(),t.ui.selection.enable(e)}}}})})(jQuery,infrae);