(function(e,t,n){var r=function(r,i){var s=e(i.selector),o=s.children(".tree"),u=i.root_url,a=new n.Template(i.url,{}),f=new n.Template(i.parents_url,{}),l=function(e,t){return e.each(function(){t<0&&(t=0),o.scrollLeft(21*t)})},c=function(t){function n(t){var r=e("#"+t[0]),i=t.slice(1);return r.length>0?(i.length>0?o.jstree("open_node",r,function(){n(i)}):o.jstree("open_node",r,function(){o.jstree("select_node",r,!0)}),!0):!1}n(t)||o.jstree("deselect_all")},h=function(t){if(t.target===undefined)return;var n=e("#"+t.target,o);n.length>0&&o.jstree("delete_node",n)},p=function(t){if(t.parent===undefined)return;var n=e("#"+t.parent,o);n.length>0&&o.jstree("refresh",n)};return o.jstree({ui:{select_limit:1},core:{animation:100},plugins:["json_data","ui","hotkeys"],json_data:{ajax:{url:function(e){return e==-1?u:a.expand({path:e.data("jstree").path})}}}}),o.bind("select_node.jstree",function(t,n){l(e(this),n.rslt.obj.parents("ul").length-2)}),o.bind("open_node.jstree",function(t,n){l(e(this),n.rslt.obj.parents("ul").length-2)}),o.bind("close_node.jstree",function(t,n){l(e(this),n.rslt.obj.parents("ul").length-3)}),o.delegate("a","click",function(t){return r.open_screen(e(this).parent().data("jstree").path),!1}),t.ui.selection.disable(s),o.jstree("disable_hotkeys"),s.bind("blur-keyboard",function(){o.jstree("disable_hotkeys")}),s.bind("focus-keyboard",function(){o.jstree("enable_hotkeys"),o.focus()}),r.shortcuts.create("navigation",o),{invalidate:function(e){e.length>0&&t.utils.each(e,function(e){switch(e.action){case"remove":h(e.info);break;case"add":case"update":p(e.info)}})},open:function(e){c(e)}}};t.smi.NavigationManager=r})(jQuery,infrae,jsontemplate);